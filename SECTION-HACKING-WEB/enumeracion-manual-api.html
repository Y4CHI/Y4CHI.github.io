<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- 
    - primary meta tags
  -->
  <title>H4ckdino - Blog</title>
  <meta name="title" content="H4ckdino - Blog">
  <meta name="description" content="Blog de hacking etico y material de estudio de informatica">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,  initial-scale=1.0">
  <meta name="author" content="H4ckdino">
  <meta name="keywords" content="Hacking, Redes, Ciberseguridad, Informatica, Red team, Programación">
  <meta property="og:title" content="H4ckdino - Blog de Hacking">
  <meta property="og:type" content="article">
  <meta property="og:image" content="https://images.pexels.com/photos/8721342/pexels-photo-8721342.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1">
  <meta property="og:url" content="https://y4chi.github.io">
  <meta property="og:description" content="¡Bienvenidos a H4ckdino, tu portal exclusivo hacia el fascinante mundo del hacking! Sumérgete en un universo de conocimientos cibernéticos, seguridad informática y tecnología punta. Descubre las últimas tendencias, trucos y herramientas que te convertirán en un maestro del ciberespacio. En H4ckdino, desentrañamos los misterios digitales y exploramos el lado audaz de la tecnología. ¡Únete a nuestra comunidad de mentes curiosas y desata tu potencial hacker!">
  <meta property="og:site_name" content="https://y4chi.github.io/SECTION-HACKING-WEB/enumeracion-manual-api.html">
  <meta property="og:locale" content="es-PE">
  <meta name="twitter:title" content="H4ckdino - Blog de Hacking">
  <meta name="twitter:description" content="¡Bienvenidos a H4ckdino, tu portal exclusivo hacia el fascinante mundo del hacking! Sumérgete en un universo de conocimientos cibernéticos, seguridad informática y tecnología punta. Descubre las últimas tendencias, trucos y herramientas que te convertirán en un maestro del ciberespacio. En H4ckdino, desentrañamos los misterios digitales y exploramos el lado audaz de la tecnología. ¡Únete a nuestra comunidad de mentes curiosas y desata tu potencial hacker!">
  <meta name="twitter:image" content="https://images.pexels.com/photos/8721342/pexels-photo-8721342.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1">
  <meta name="twitter:site" content="https://y4chi.github.io">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="theme-color" content="#0B2447">

  <!-- 
    - favicon
  -->
  <link rel="shortcut icon" href="./favicon.svg" type="image/svg+xml">

  <!-- 
    - google font link
  -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@300;400;500;600;700;800&display=swap"
    rel="stylesheet">
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
	<script src="https://kit.fontawesome.com/41bcea2ae3.js" crossorigin="anonymous"></script>


  <!--codigo sintax-->

  

  <!-- 
    - custom css link
  -->
  <link rel="stylesheet" href="../assets/css/style.css">
  <link rel="stylesheet" href="../assets/css/header.css">
  <link rel="stylesheet" href="../assets/css/contenedor.css">
  <link rel="stylesheet" href="../assets/css/footer.css">
  <link rel="stylesheet" type="text/css" href="../assets/css/codigo.css">


  <!-- 
    - preload images
  -->
  <link rel="preload" as="image" href="./assets/images/hero-banner.png">
  <link rel="preload" as="image" href="./assets/images/pattern-2.svg">
  <link rel="preload" as="image" href="./assets/images/pattern-3.svg">

</head>

<body id="top">

  <!-- 
    - #HEADER
  -->
  <header class="header">
		<div class="logo">
		<img class="logo1" src="./assets/images/logo/menor4.png" alt="">
		</div>
	
		<input type="checkbox" id="toggle">
		<label for="toggle"><img class="img2"  src="./assets/images/svg/menu.svg" alt="menu"></label>
	
	
		<nav class="navigation">
			<ul>
				<li><a href="../index.html"> INICIO </a></li>
				<li><a href="#"> SEGURIDAD INFORMATICA <i class=" fa-sharp fa-solid fa-caret-down"></i></a>
				<ul>
					<li><a href="../SECTON-HACKING-WIFI/index.html">HACKING WIFI</a></li>
					<li><a href="../SECTION-HACKING-WEB/index.html">HACKING WEB</a></li>
					<li><a href="../SECTION-MALWARE/index.html">MALWARE</a></li>
          <li><a href="../SECTION-BYPASS/index.html">BYPASS</a></li>
	
				</ul>
			</li>
      <li><a href="#"> INFORMATICA <i class=" fa-sharp fa-solid fa-caret-down"></i></a>
				<ul>
					<li><a href="../SECTION-LINUX/index.html">LINUX</a></li>
					<li><a href="../SECTION-PROGRAMACION/index.html">PROGRAMACIÓN</a></li>
					<li><a href="../SECTION-REDES/index.html">REDES</a></li>
				
	
				</ul>
			</li>
				<li><a href="">CTF <i class=" fa-sharp fa-solid fa-caret-down"></i></a>
				<ul>
					<li><a href="../SECTION-HACKTHEBOX/index.html">HACKTHEBOX</a></li>
					
				
	
				</ul>
	
				</li>
				<li><a href="#"> ACERCA DE </a></li>
			
			
			
			</ul>
	
		</nav>

	</header>

  <main class="main-blog">

    <h1 id="h1-main">Enumeración manual de una API</h1>
    <h3 class="h3-importante">Introducción    </h3>
    <p>La enumeración manual de una API es una tarea fundamental en el mundo del pentesting, o prueba de penetración, que implica explorar y analizar minuciosamente una interfaz de programación de aplicaciones para identificar posibles vulnerabilidades y debilidades en la seguridad. Aunque la automatización es una herramienta valiosa en esta disciplina, la enumeración manual se destaca por su enfoque ético y meticuloso. En este proceso, los expertos en seguridad evalúan cuidadosamente cada punto de acceso, sin depender únicamente de herramientas automatizadas, con el objetivo de garantizar la integridad y la confidencialidad de los sistemas y datos. Esta introducción resalta la importancia de la enumeración manual en pentesting, subrayando su compromiso con los principios éticos y la protección de la información.</p>
    <h3 class="h3-importante">Comenzando</h3>
    <p>Como bien sabemos las rutas esta compuestas por el nombre de la api y su versión <code class="code-command">nombre-de-api/versión    </code> </p>
    <p>Para enumerar dichos nombres y rutas podemos usar la tool gobuster junto a su parámetro -p, lo que tenemos que hacer ahora es crear un archivo con el siguiente contenido, en este caso estaremos buscando versiones 1 y versiones 2 de APIs, pero podemos aún mentar el numero de versiones existentes </p>
    <div class="code-container">
      <pre class="lenguage-python">
      <code>
        # myfile
        {GOBUSTER}/v1    
        {GOBUSTER}/v2</code>
      </pre>
    </div>
    <button class="copy-button">Copiar</button>

    <p>cabe aclarar que tenemos que usar la palabra reservada “{GOBUSTER}” ya que es donde se remplazarán con las palabras de nuestra lista </p>
    <p>Estamos listos para enumerar la API con el siguiente comando:</p>
    <p><code class="code-command">gobuster dir -u http://127.0.0.1:5555 -w /usr/share/wordlists/dirb/big.txt -p myfile   </code></p>
    <p>Output:</p>
    <div class="code-container">
      <pre class="lenguage-python">
      <code>
        /gatos/v2 (Status: 200) [Size: 100]
        /ui       (Status: 200) [Size: 2503]
        /users/v1 (Status: 200) [Size: 443]</code>
      </pre>
    </div>
    <button class="copy-button">Copiar</button>

    <p>Es importante resaltar que el directorio  <code class="code-command">/ui   </code>sirve para almacenar la documentación de la API, es habitual verla en en ejercicios de caja blanca, pero no siempre es un lujo en los ejercicios de caja negra.</p>
    <p>Notamos que descubrimos 3 rutas, a las cuales 1 de ellas será a la que investiguemos primero  <code class="code-command"> /users/v1  </code></p> 
    <p>Comencemos con <code class="code-command"> /users/v1  </code>  aplicando un <code class="code-command">curl   </code>junto al parámetro <code class="code-command">  -i </code> que nos permitirá obtener los headers del servidor:</p> 

    <div class="code-container">
      <pre class="lenguage-python">
      <code>
        curl -i http://127.0.0.1:5555/users/v1 </code>
      </pre>
    </div>
    <button class="copy-button">Copiar</button>

    <p>Output:</p>
    <div class="imagenes-blog">
      <img class="img-contenido-blog" src="assets/images/articulos/enumeracion-manual-api/001.webp" alt="Imagen hacking API" />
    </div>

    <p>Observamos que obtenemos cuentas de correos y nombres de usuarios entre ellos uno de administrador!</p>
    <p>Esto da pie a otro ataque de fuerza bruta usando Gobuster con la finalidad de encontrar algo en el directorio <code class="code-command">/admin   </code></p>

    <div class="code-container">
      <pre class="lenguage-python">
      <code>
        gobuster dir -u http://localhost:5555/users/v1/admin/ -w /usr/share/wordlists/dirb/small.txt</code>
      </pre>
    </div>
    <button class="copy-button">Copiar</button>

    <p>Output:</p>

    <div class="imagenes-blog">
      <img class="img-contenido-blog" src="assets/images/articulos/enumeracion-manual-api/002.webp" alt="Imagen hacking API"/>
  </div>

  <p>Podemos ver un directorio muy interesante <code class="code-command">  /password </code> </p>
  <p>Volvemos a usar curl con la finalidad de echarle un ojo al contenido de la ruta</p>

  <div class="imagenes-blog">
    <img class="img-contenido-blog" src="assets/images/articulos/enumeracion-manual-api/003.webp" alt="Imagen hacking API"/>
</div>

<p>Muchos podríamos esperar un código de error 404 de page not found, pero observamos un 405 este código de estado nos indica que el recurso, en este caso el método http que estamos usando para acceder a ella no esta soportado esto claramente se muestra en <code class="code-command">"detail": "The method is not allowed for the requested URL."   </code>por defecto curl utiliza por defecto el método GET para realizar peticiones. En este punto intentemos usar otros métodos para interactuar con la ruta de la API métodos tales como POST o PUT que si son admitidos específicamente por esta API</p>

<p><code class="code-command"> curl -d '{"password":"lab","username":"offsec"}' -H 'Content-Type: application/json' http://192.168.50.16:5002/users/v1/login  </code></p>

<p>Antes de intentar un método diferente, verifiquemos si las credenciales sobrescritas son aceptadas o no.</p>


<div class="code-container">
  <pre class="lenguage-python">
  <code>
    curl -i http://localhost:5555/users/v1/login</code>
  </pre>
</div>
<button class="copy-button">Copiar</button>

<p>Aunque se nos presentó un mensaje 404 NOT FOUND, el mensaje de estado afirma que el usuario no ha sido encontrado; otra clara señal de que la propia API existe. Sólo tenemos que encontrar una forma adecuada de interactuar con ella.</p>
<p>Sabemos que uno de los nombres de usuario es admin, así que podemos intentar iniciar sesión con este nombre de usuario y una contraseña falsa para verificar que nuestra API existe. contraseña falsa para verificar que nuestra estrategia tiene sentido.</p>
<p>A continuación, intentaremos convertir la petición GET anterior en una POST y proporcionar nuestra carga útil en el formato JSON. Vamos a elaborar nuestra petición pasando primero el nombre de usuario admin y la contraseña como datos JSON mediante el parámetro <code class="code-command"> -d  </code> . También especificaremos "json" como "Content-Type" mediante especificando una nueva cabecera con  <code class="code-command"> -H  </code>.</p>


<div class="code-container">
  <pre class="lenguage-python">
  <code>
    curl -d '{"password":"fake","username":"admin"}' -H 'Content-Type: application/json' http://localhost:5555/users/v1/login</code>
  </pre>
</div>
<button class="copy-button">Copiar</button>

<p>El mensaje de retorno de la API muestra que la autenticación falló, lo que significa que los parámetros de la API están correctamente formados.</p>
<p>Como no conocemos la contraseña de admin, probemos otra ruta y comprobemos si podemos registrarnos como un nuevo usuario. Esto podría llevarnos a una superficie de ataque diferente. Intentemos registrar un nuevo usuario con la siguiente sintaxis añadiendo una estructura de datos JSON que especifica el nombre de usuario y la contraseña deseados:</p>

<div class="code-container">
  <pre class="lenguage-python">
  <code>
    curl -d '{"password":"123456","username":"testing"}' -H 'Content-Type: application/json' http://localhost:5555/users/v1/register </code>
  </pre>
</div>
<button class="copy-button">Copiar</button>


<p>La API respondió con un mensaje de error indicando que debíamos incluir también una dirección de correo electrónico. Nosotros podríamos aprovechar para determinar si hay alguna clave administrativa de la que podamos abusar. Añadamos la clave admin, seguida de un valor True.</p>

<div class="code-container">
  <pre class="lenguage-python">
  <code>
    curl -d '{"password":"123456","username":"pwend","email":"pwend@gmail.com","admin":"True"}' -H 'Content-Type: application/json' http://localhost:5555/users/v1/register</code>
  </pre>
</div>
<button class="copy-button">Copiar</button>
<p>Pudimos registrar con exito al nuevo usuario. Lo que haremos ahora es iniciar sesión con las nuevas credenciales creadas</p>

<div class="code-container">
  <pre class="lenguage-python">
  <code>
    curl -d '{"password":"123456","username":"pwend"}' -H 'Content-Type: application/json' http://localhost:5555/users/v1/login </code>
  </pre>
</div>
<button class="copy-button">Copiar</button>

<p>Finalmente la API nos devuelve un JWT de usuario administrador</p>




  <br><br><br>
</main>





  <!-- 
    - #BACK TO TOP
  -->
  <footer class="footer"> 
    <div class="izquierda">  
  
      <a href="#" id="footer-a"><a href="#">
        <img src="../assets/images/logo/menorH.png" alt="logo h4ckdino">
      </a>  © 2023 h4ckdino, Inc. </a>
      <a href="#" id="footer-a">Ponte en contacto con nosotros</a>
      <a href="#" id="footer-a" >Configuración de cookies</a>
      <a href="#" id="footer-a" >Politica de privacidad</a>
      
  
      
    </div>
  </footer>
  





  <!-- 
    - custom js link
  -->

  <!-- 
    - ionicon link
  -->
  <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>

  <script src="../assets/js/copiar-boton.js"></script>
  <script src="./assets/js/script.js"></script>


</body>

</html>